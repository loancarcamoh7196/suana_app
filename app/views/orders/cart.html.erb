<%# Carro de Compra %>
<div class="container">
   <div class="row">
      <div class="col-12">
         <h2>Carro de Compra</h2>
      
         <%= link_to '<i class="fas fa-trash"></i> Vaciar Carro'.html_safe , empty_cart_orders_path, class: 'btn btn-outline-danger float-right', method: :delete %>  
      
         <br> <br>
         <% if @orders.present? %>
         <table id="table-cart" class="table table-hover table-striped">
            <thead class="thead-dark">
               <tr>
                  <th>ID</th>
                  <th>Nombre</th>
                  <th>Valor Unitario</th>
                  <th>Cantidad</th>
                  <th>Subtotal</th>
                  <th> </th>
               </tr>
            </thead>
          <tbody>
            <% @orders.each do |order| %>
               <tr id="<% order.id %>">
                  <td><%= order.id %></td>
                  <td><%= order.detail.product.title.html_safe %></td>
                  <td>$<span id="price-<%= order.id %>"><%= order.detail.price.to_i %></span> </td>
                  <td id="quantity-bottons">
                     <% if order.quantity > 1 %>
                        <%= link_to '<i class="far fa-minus-square"></i>'.html_safe, order_remove_one_item_path(order.id), method: :patch, remote: true, class: 'btn-outline-danger btn-sm', id: 'btn-plus' %>
                     <%elsif order.quantity == 1  %>
                        <i class="far fa-minus-square btn-sm btn-outline-secondary" id='btn-plus-bloque' ></i>
                     <% end %>
                     <span id="quantity-<%= order.id %>"><%= order.quantity.to_i %></span>
                     <% if order.quantity > 0 && order.detail.quantity > 0 %>
                        <%= link_to '<i class="far fa-plus-square"></i>'.html_safe, detail_orders_path(order.detail), method: :post, remote: true, class: 'btn-outline-success btn-sm', id: "mas-#{order.id}" %>
                     <% else %>
                        <i class="far fa-plus-square btn-sm btn-outline-secondary" id='btn-plus-bloque' >
                     <% end %>
                  </td>
                  <td>
                     $<span id="subtotal-<%= order.id %>" value="<%= (order.price.to_i * order.quantity) %>"><%= (order.price.to_i * order.quantity) %></span>   
                  </td>
                  <td>
                     <%= link_to '<i class="fas fa-window-close"></i>'.html_safe, order_path(order.id), method: :delete, class: 'btn-sm btn-outline-danger' %>
                  </td>
               </tr>
            <% end %>
            <tr>
              <td colspan="4" class="text-right"><strong>Total</strong></td>
              <td colspan="2">$ <span id="total"><%= @total %> </span> </td>
            </tr>
          </tbody>
        </table>        
      <% else %>
        No tienes productos en el carro... <br><br>
      <% end %>
      


      <%= link_to 'Volver', root_path, class: 'btn btn-info btn-lg' %>
      <%= link_to '<i class="fas fa-cash-register"></i>  Pagar'.html_safe, choose_address_path, class: 'btn btn-success btn-lg float-right' %>
    </div>
  </div>
</div>

<a href=""></a>